"use strict";const e=require("./base/Exchange"),{ExchangeError:t}=require("./base/errors");module.exports=class extends e{describe(){return this.deepExtend(super.describe(),{id:"lakebtc",name:"LakeBTC",countries:"US",version:"api_v2",has:{CORS:!0,createMarketOrder:!1,fetchTickers:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/28074120-72b7c38a-6660-11e7-92d9-d9027502281d.jpg",api:"https://api.lakebtc.com",www:"https://www.lakebtc.com",doc:["https://www.lakebtc.com/s/api_v2","https://www.lakebtc.com/s/api"]},api:{public:{get:["bcorderbook","bctrades","ticker"]},private:{post:["buyOrder","cancelOrders","getAccountInfo","getExternalAccounts","getOrders","getTrades","openOrders","sellOrder"]}},fees:{trading:{maker:.0015,taker:.002}}})}async fetchMarkets(){let e=await this.publicGetTicker(),t=[],s=Object.keys(e);for(let i=0;i<s.length;i++){let a=s[i],r=e[a],o=a.slice(0,3),c=a.slice(3,6),l=o.toUpperCase(),d=c.toUpperCase(),h=l+"/"+d;t.push({id:a,symbol:h,base:l,quote:d,baseId:o,quoteId:c,info:r})}return t}async fetchBalance(e={}){await this.loadMarkets();let t=await this.privatePostGetAccountInfo(),s=t.balance,i={info:t},a=Object.keys(s);for(let e=0;e<a.length;e++){let t=a[e],r=t;if(t in this.currencies_by_id){r=this.currencies_by_id[t].code}let o=parseFloat(s[t]),c={free:o,used:0,total:o};i[r]=c}return this.parseBalance(i)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();let i=await this.publicGetBcorderbook(this.extend({symbol:this.marketId(e)},s));return this.parseOrderBook(i)}parseTicker(e,t){let s=this.milliseconds(),i=void 0;void 0!==t&&(i=t.symbol);let a=this.safeFloat(e,"last");return{symbol:i,timestamp:s,datetime:this.iso8601(s),high:this.safeFloat(e,"high"),low:this.safeFloat(e,"low"),bid:this.safeFloat(e,"bid"),bidVolume:void 0,ask:this.safeFloat(e,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:a,last:a,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeFloat(e,"volume"),quoteVolume:void 0,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();let s=await this.publicGetTicker(t),i=Object.keys(s),a={};for(let e=0;e<i.length;e++){let t=i[e],r=s[t],o=void 0;t in this.markets_by_id&&(t=(o=this.markets_by_id[t]).symbol),a[t]=this.parseTicker(r,o)}return a}async fetchTicker(e,t={}){await this.loadMarkets();let s=this.market(e),i=await this.publicGetTicker(t);return this.parseTicker(i[s.id],s)}parseTrade(e,t){let s=1e3*e.date;return{info:e,timestamp:s,datetime:this.iso8601(s),symbol:t.symbol,id:e.tid.toString(),order:void 0,type:void 0,side:void 0,price:this.safeFloat(e,"price"),amount:this.safeFloat(e,"amount")}}async fetchTrades(e,t,s,i={}){await this.loadMarkets();let a=this.market(e),r=await this.publicGetBctrades(this.extend({symbol:a.id},i));return this.parseTrades(r,a,t,s)}async createOrder(e,s,i,a,r,o={}){if(await this.loadMarkets(),"market"===s)throw new t(this.id+" allows limit orders only");let c="privatePost"+this.capitalize(i)+"Order",l={params:[r,a,this.market(e).id]},d=await this[c](this.extend(l,o));return{info:d,id:d.id.toString()}}async cancelOrder(e,t,s={}){return await this.loadMarkets(),await this.privatePostCancelOrder({params:e})}nonce(){return this.microseconds()}sign(e,t="public",s="GET",i={},a,r){let o=this.urls.api+"/"+this.version;if("public"===t)o+="/"+e,Object.keys(i).length&&(o+="?"+this.urlencode(i));else{this.checkRequiredCredentials();let t=this.nonce(),o="";"params"in i&&(o=i.params.join());let c=this.urlencode({tonce:t,accesskey:this.apiKey,requestmethod:s.toLowerCase(),id:t,method:e,params:o});r=this.json({method:e,params:o,id:t});let l=this.hmac(this.encode(c),this.encode(this.secret),"sha1"),d=this.encode(this.apiKey+":"+l);a={"Json-Rpc-Tonce":t.toString(),Authorization:"Basic "+this.decode(this.stringToBase64(d)),"Content-Type":"application/json"}}return{url:o,method:s,body:r,headers:a}}async request(e,s="public",i="GET",a={},r,o){let c=await this.fetch2(e,s,i,a,r,o);if("error"in c)throw new t(this.id+" "+this.json(c));return c}};
//# sourceMappingURL=lakebtc.js.map