"use strict";const e=require("./base/Exchange"),{ExchangeError:t}=require("./base/errors");module.exports=class extends e{describe(){return this.deepExtend(super.describe(),{id:"coingi",name:"Coingi",rateLimit:1e3,countries:["PA","BG","CN","US"],has:{CORS:!1,fetchTickers:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/28619707-5c9232a8-7212-11e7-86d6-98fe5d15cc6e.jpg",api:{www:"https://coingi.com",current:"https://api.coingi.com",user:"https://api.coingi.com"},www:"https://coingi.com",doc:"http://docs.coingi.apiary.io/"},api:{www:{get:[""]},current:{get:["order-book/{pair}/{askCount}/{bidCount}/{depth}","transactions/{pair}/{maxCount}","24hour-rolling-aggregation"]},user:{post:["balance","add-order","cancel-order","orders","transactions","create-crypto-withdrawal"]}},fees:{trading:{tierBased:!1,percentage:!0,taker:.002,maker:.002},funding:{tierBased:!1,percentage:!1,withdraw:{BTC:.001,LTC:.01,DOGE:2,PPC:.02,VTC:.2,NMC:2,DASH:.002,USD:10,EUR:10},deposit:{BTC:0,LTC:0,DOGE:0,PPC:0,VTC:0,NMC:0,DASH:0,USD:5,EUR:1}}}})}async fetchMarkets(){let e=void 0;try{this.parseJsonResponse=!1,e=await this.wwwGet(),this.parseJsonResponse=!0}catch(e){throw this.parseJsonResponse=!0,e}let t=e.split('do=currencyPairSelector-selectCurrencyPair" class="active">')[1].split('<div class="currency-pair-label">'),i=[];for(let e=1;e<t.length;e++){let r=t[e].split("</div>")[0],s=r;r=(r=r.replace("/","-")).toLowerCase();let[a,o]=s.split("/"),n={amount:8,price:8},c=Math.pow(10,-n.amount);i.push({id:r,symbol:s,base:a,quote:o,info:r,lot:c,active:!0,precision:n,limits:{amount:{min:c,max:Math.pow(10,n.amount)},price:{min:Math.pow(10,-n.price),max:void 0},cost:{min:0,max:void 0}}})}return i}async fetchBalance(e={}){await this.loadMarkets();let t=[],i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){let r=i[e];t.push(r.toLowerCase())}let r=await this.userPostBalance({currencies:t.join(",")}),s={info:r};for(let e=0;e<r.length;e++){let t=r[e],i=t.currency.name;i=i.toUpperCase();let a={free:t.available,used:t.blocked+t.inOrders+t.withdrawing,total:0};a.total=this.sum(a.free,a.used),s[i]=a}return this.parseBalance(s)}async fetchOrderBook(e,t=512,i={}){await this.loadMarkets();let r=this.market(e),s=await this.currentGetOrderBookPairAskCountBidCountDepth(this.extend({pair:r.id,depth:32,askCount:t,bidCount:t},i));return this.parseOrderBook(s,void 0,"bids","asks","price","baseAmount")}parseTicker(e,t){let i=this.milliseconds(),r=void 0;return t&&(r=t.symbol),{symbol:r,timestamp:i,datetime:this.iso8601(i),high:e.high,low:e.low,bid:e.highestBid,bidVolume:void 0,ask:e.lowestAsk,askVolume:void 0,vwap:void 0,open:void 0,close:void 0,last:void 0,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:e.baseVolume,quoteVolume:e.counterVolume,info:e}}async fetchTickers(e,t={}){await this.loadMarkets();let i=await this.currentGet24hourRollingAggregation(t),r={};for(let e=0;e<i.length;e++){let t=i[e],s=t.currencyPair.base.toUpperCase()+"/"+t.currencyPair.counter.toUpperCase(),a=void 0;s in this.markets&&(a=this.markets[s]),r[s]=this.parseTicker(t,a)}return r}async fetchTicker(e,i={}){await this.loadMarkets();let r=await this.fetchTickers(void 0,i);if(e in r)return r[e];throw new t(this.id+" return did not contain "+e)}parseTrade(e,t){return t||(t=this.markets_by_id[e.currencyPair]),{id:e.id,info:e,timestamp:e.timestamp,datetime:this.iso8601(e.timestamp),symbol:t.symbol,type:void 0,side:void 0,price:e.price,amount:e.amount}}async fetchTrades(e,t,i,r={}){await this.loadMarkets();let s=this.market(e),a=await this.currentGetTransactionsPairMaxCount(this.extend({pair:s.id,maxCount:128},r));return this.parseTrades(a,s,t,i)}async createOrder(e,t,i,r,s,a={}){await this.loadMarkets();let o={currencyPair:this.marketId(e),volume:r,price:s,orderType:"buy"===i?0:1},n=await this.userPostAddOrder(this.extend(o,a));return{info:n,id:n.result}}async cancelOrder(e,t,i={}){return await this.loadMarkets(),await this.userPostCancelOrder({orderId:e})}sign(e,t="current",i="GET",r={},s,a){let o=this.urls.api[t];"www"!==t&&(o+="/"+t+"/"+this.implodeParams(e,r));let n=this.omit(r,this.extractParams(e));if("current"===t)Object.keys(n).length&&(o+="?"+this.urlencode(n));else if("user"===t){this.checkRequiredCredentials();let e=this.nonce(),t=this.extend({token:this.apiKey,nonce:e},n),i=e.toString()+"$"+this.apiKey;t.signature=this.hmac(this.encode(i),this.encode(this.secret)),a=this.json(t),s={"Content-Type":"application/json"}}return{url:o,method:i,body:a,headers:s}}async request(e,i="current",r="GET",s={},a,o){let n=await this.fetch2(e,i,r,s,a,o);if("string"!=typeof n&&"errors"in n)throw new t(this.id+" "+this.json(n));return n}};
//# sourceMappingURL=coingi.js.map