"use strict";const e=require("./base/Exchange"),{ExchangeError:t,AuthenticationError:s,DDoSProtection:i}=require("./base/errors");module.exports=class extends e{describe(){return this.deepExtend(super.describe(),{id:"coinbase",name:"coinbase",countries:"US",rateLimit:400,version:"v2",userAgent:this.userAgents.chrome,headers:{"CB-VERSION":"2018-05-30"},has:{CORS:!0,cancelOrder:!1,createDepositAddress:!1,createOrder:!1,deposit:!1,fetchBalance:!0,fetchClosedOrders:!1,fetchCurrencies:!0,fetchDepositAddress:!1,fetchMarkets:!1,fetchMyTrades:!1,fetchOHLCV:!1,fetchOpenOrders:!1,fetchOrder:!1,fetchOrderBook:!1,fetchOrders:!1,fetchTicker:!0,fetchTickers:!1,fetchBidsAsks:!1,fetchTrades:!1,withdraw:!1,fetchTransactions:!1,fetchDeposits:!1,fetchWithdrawals:!1},urls:{logo:"https://user-images.githubusercontent.com/1294454/40811661-b6eceae2-653a-11e8-829e-10bfadb078cf.jpg",api:"https://api.coinbase.com",www:"https://www.coinbase.com",doc:"https://developers.coinbase.com/api/v2",fees:"https://support.coinbase.com/customer/portal/articles/2109597-buy-sell-bank-transfer-fees"},requiredCredentials:{apiKey:!0,secret:!0},api:{public:{get:["currencies","time","exchange-rates","users/{user_id}","prices/{symbol}/buy","prices/{symbol}/sell","prices/{symbol}/spot"]},private:{get:["accounts","accounts/{account_id}","accounts/{account_id}/addresses","accounts/{account_id}/addresses/{address_id}","accounts/{account_id}/addresses/{address_id}/transactions","accounts/{account_id}/transactions","accounts/{account_id}/transactions/{transaction_id}","accounts/{account_id}/buys","accounts/{account_id}/buys/{buy_id}","accounts/{account_id}/sells","accounts/{account_id}/sells/{sell_id}","accounts/{account_id}/deposits","accounts/{account_id}/deposits/{deposit_id}","accounts/{account_id}/withdrawals","accounts/{account_id}/withdrawals/{withdrawal_id}","payment-methods","payment-methods/{payment_method_id}","user","user/auth"],post:["accounts","accounts/{account_id}/primary","accounts/{account_id}/addresses","accounts/{account_id}/transactions","accounts/{account_id}/transactions/{transaction_id}/complete","accounts/{account_id}/transactions/{transaction_id}/resend","accounts/{account_id}/buys","accounts/{account_id}/buys/{buy_id}/commit","accounts/{account_id}/sells","accounts/{account_id}/sells/{sell_id}/commit","accounts/{account_id}/deposists","accounts/{account_id}/deposists/{deposit_id}/commit","accounts/{account_id}/withdrawals","accounts/{account_id}/withdrawals/{withdrawal_id}/commit"],put:["accounts/{account_id}","user"],delete:["accounts/{id}","accounts/{account_id}/transactions/{transaction_id}"]}},exceptions:{two_factor_required:s,param_required:t,validation_error:t,invalid_request:t,personal_details_required:s,identity_verification_required:s,jumio_verification_required:s,jumio_face_match_verification_required:s,unverified_email:s,authentication_error:s,invalid_token:s,revoked_token:s,expired_token:s,invalid_scope:s,not_found:t,rate_limit_exceeded:i,internal_server_error:t},markets:{"BTC/USD":{id:"btc-usd",symbol:"BTC/USD",base:"BTC",quote:"USD"},"LTC/USD":{id:"ltc-usd",symbol:"LTC/USD",base:"LTC",quote:"USD"},"ETH/USD":{id:"eth-usd",symbol:"ETH/USD",base:"ETH",quote:"USD"},"BCH/USD":{id:"bch-usd",symbol:"BCH/USD",base:"BCH",quote:"USD"}}})}async fetchTime(){let e=(await this.publicGetTime()).data;return this.parse8601(e.iso)}async fetchCurrencies(e={}){let t=(await this.publicGetCurrencies(e)).data,s={};for(let e=0;e<t.length;e++){let i=t[e],a=i.id,c=i.name,o=this.commonCurrencyCode(a),n=this.safeFloat(i,"min_size");s[o]={id:a,code:o,info:i,name:c,active:!0,status:"ok",fee:void 0,precision:void 0,limits:{amount:{min:n,max:void 0},price:{min:void 0,max:void 0},cost:{min:void 0,max:void 0},withdraw:{min:void 0,max:void 0}}}}return s}async fetchTicker(e,t={}){await this.loadMarkets();let s=this.seconds(),i=this.market(e),a=this.extend({symbol:i.id},t),c=await this.publicGetPricesSymbolBuy(a),o=await this.publicGetPricesSymbolSell(a),n=await this.publicGetPricesSymbolSpot(a),r=this.safeFloat(c.data,"amount"),d=this.safeFloat(o.data,"amount"),u=this.safeFloat(n.data,"amount");return{symbol:e,timestamp:s,datetime:this.iso8601(s),bid:d,ask:r,last:u,high:void 0,low:void 0,bidVolume:void 0,askVolume:void 0,vwap:void 0,open:void 0,close:void 0,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:void 0,info:{buy:c,sell:o,spot:n}}}async fetchBalance(e={}){let t=await this.privateGetAccounts(),s=t.data,i={info:t};for(let e=0;e<s.length;e++){let t=s[e],a=t.balance.currency,c={free:this.safeFloat(t.balance,"amount"),used:void 0,total:this.safeFloat(t.balance,"amount")};i[a]=c}return this.parseBalance(i)}sign(e,t="public",s="GET",i={},a,c){let o="/"+this.implodeParams(e,i),n=this.omit(i,this.extractParams(e));"GET"===s&&Object.keys(n).length&&(o+="?"+this.urlencode(n));let r=this.urls.api+"/"+this.version+o;if("private"===t){this.checkRequiredCredentials();let e=this.nonce().toString(),t="";"GET"!==s&&Object.keys(n).length&&(t=c=this.json(n));let i=e+s+"/"+this.version+o+t,r=this.hmac(this.encode(i),this.encode(this.secret));a={"CB-ACCESS-KEY":this.apiKey,"CB-ACCESS-SIGN":r,"CB-ACCESS-TIMESTAMP":e,"Content-Type":"application/json"}}return{url:r,method:s,body:c,headers:a}}handleErrors(e,s,i,a,c,o){if("string"==typeof o&&!(o.length<2||"{"!==o[0]&&"["!==o[0])){let e=JSON.parse(o),s=this.id+" "+o,i=this.exceptions,a=this.safeString(e,"error");if(void 0!==a)throw a in i?new i[a](s):new t(s);let c=this.safeValue(e,"errors");if(void 0!==c&&Array.isArray(c)){if(c.length>0&&void 0!==(a=this.safeString(c[0],"id")))throw a in i?new i[a](s):new t(s)}if(void 0===this.safeValue(e,"data"))throw new t(this.id+" failed due to a malformed response "+this.json(e))}}};
//# sourceMappingURL=coinbase.js.map