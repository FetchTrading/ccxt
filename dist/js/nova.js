"use strict";const e=require("./base/Exchange"),{ExchangeError:t}=require("./base/errors");module.exports=class extends e{describe(){return this.deepExtend(super.describe(),{id:"nova",name:"Novaexchange",countries:"TZ",rateLimit:2e3,version:"v2",has:{CORS:!1,createMarketOrder:!1},urls:{logo:"https://user-images.githubusercontent.com/1294454/30518571-78ca0bca-9b8a-11e7-8840-64b83a4a94b2.jpg",api:"https://novaexchange.com/remote",www:"https://novaexchange.com",doc:"https://novaexchange.com/remote/faq"},api:{public:{get:["markets/","markets/{basecurrency}/","market/info/{pair}/","market/orderhistory/{pair}/","market/openorders/{pair}/buy/","market/openorders/{pair}/sell/","market/openorders/{pair}/both/","market/openorders/{pair}/{ordertype}/"]},private:{post:["getbalances/","getbalance/{currency}/","getdeposits/","getwithdrawals/","getnewdepositaddress/{currency}/","getdepositaddress/{currency}/","myopenorders/","myopenorders_market/{pair}/","cancelorder/{orderid}/","withdraw/{currency}/","trade/{pair}/","tradehistory/","getdeposithistory/","getwithdrawalhistory/","walletstatus/","walletstatus/{currency}/"]}}})}async fetchMarkets(){let e=(await this.publicGetMarkets()).markets,t=[];for(let a=0;a<e.length;a++){let r=e[a],s=r.marketname,[i,o]=s.split("_"),n=o+"/"+i,d=!0;r.disabled&&(d=!1),t.push({id:s,symbol:n,base:o,quote:i,active:d,info:r})}return t}async fetchOrderBook(e,t,a={}){await this.loadMarkets();let r=await this.publicGetMarketOpenordersPairBoth(this.extend({pair:this.marketId(e)},a));return this.parseOrderBook(r,void 0,"buyorders","sellorders","price","amount")}async fetchTicker(e,t={}){await this.loadMarkets();let a=(await this.publicGetMarketInfoPair(this.extend({pair:this.marketId(e)},t))).markets[0],r=this.milliseconds(),s=this.safeFloat(a,"last_price");return{symbol:e,timestamp:r,datetime:this.iso8601(r),high:this.safeFloat(a,"high24h"),low:this.safeFloat(a,"low24h"),bid:this.safeFloat(a,"bid"),bidVolume:void 0,ask:this.safeFloat(a,"ask"),askVolume:void 0,vwap:void 0,open:void 0,close:s,last:s,previousClose:void 0,change:this.safeFloat(a,"change24h"),percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:this.safeFloat(a,"volume24h"),info:a}}parseTrade(e,t){let a=1e3*e.unix_t_datestamp;return{info:e,timestamp:a,datetime:this.iso8601(a),symbol:t.symbol,id:void 0,order:void 0,type:void 0,side:e.tradetype.toLowerCase(),price:this.safeFloat(e,"price"),amount:this.safeFloat(e,"amount")}}async fetchTrades(e,t,a,r={}){await this.loadMarkets();let s=this.market(e),i=await this.publicGetMarketOrderhistoryPair(this.extend({pair:s.id},r));return this.parseTrades(i.items,s,t,a)}async fetchBalance(e={}){await this.loadMarkets();let t=await this.privatePostGetbalances(),a=t.balances,r={info:t};for(let e=0;e<a.length;e++){let t=a[e],s=t.currency,i=parseFloat(t.amount_lockbox),o=parseFloat(t.amount_trades),n={free:parseFloat(t.amount),used:this.sum(i,o),total:parseFloat(t.amount_total)};r[s]=n}return this.parseBalance(r)}async createOrder(e,a,r,s,i,o={}){if("market"===a)throw new t(this.id+" allows limit orders only");await this.loadMarkets(),s=s.toString(),i=i.toString();let n=this.market(e),d={tradetype:r.toUpperCase(),tradeamount:s,tradeprice:i,tradebase:1,pair:n.id};return{info:await this.privatePostTradePair(this.extend(d,o)),id:void 0}}async cancelOrder(e,t,a={}){return await this.privatePostCancelorder(this.extend({orderid:e},a))}sign(e,t="public",a="GET",r={},s,i){let o=this.urls.api+"/"+this.version+"/";"private"===t&&(o+=t+"/"),o+=this.implodeParams(e,r);let n=this.omit(r,this.extractParams(e));if("public"===t)Object.keys(n).length&&(o+="?"+this.urlencode(n));else{this.checkRequiredCredentials();let e=this.nonce().toString();o+="?"+this.urlencode({nonce:e});let t=this.hmac(this.encode(o),this.encode(this.secret),"sha512","base64");i=this.urlencode(this.extend({apikey:this.apiKey,signature:t},n)),s={"Content-Type":"application/x-www-form-urlencoded"}}return{url:o,method:a,body:i,headers:s}}async request(e,a="public",r="GET",s={},i,o){let n=await this.fetch2(e,a,r,s,i,o);if("status"in n&&"success"!==n.status)throw new t(this.id+" "+this.json(n));return n}};
//# sourceMappingURL=nova.js.map