"use strict";const e=require("./base/Exchange"),{ExchangeError:t}=require("./base/errors");module.exports=class extends e{describe(){return this.deepExtend(super.describe(),{id:"coinmate",name:"CoinMate",countries:["GB","CZ","EU"],rateLimit:1e3,has:{CORS:!0},urls:{logo:"https://user-images.githubusercontent.com/1294454/27811229-c1efb510-606c-11e7-9a36-84ba2ce412d8.jpg",api:"https://coinmate.io/api",www:"https://coinmate.io",doc:["http://docs.coinmate.apiary.io","https://coinmate.io/developers"]},requiredCredentials:{apiKey:!0,secret:!0,uid:!0},api:{public:{get:["orderBook","ticker","transactions"]},private:{post:["balances","bitcoinWithdrawal","bitcoinDepositAddresses","buyInstant","buyLimit","cancelOrder","cancelOrderWithInfo","createVoucher","openOrders","redeemVoucher","sellInstant","sellLimit","transactionHistory","unconfirmedBitcoinDeposits"]}},markets:{"BTC/EUR":{id:"BTC_EUR",symbol:"BTC/EUR",base:"BTC",quote:"EUR",precision:{amount:4,price:2}},"BTC/CZK":{id:"BTC_CZK",symbol:"BTC/CZK",base:"BTC",quote:"CZK",precision:{amount:4,price:2}},"LTC/BTC":{id:"LTC_BTC",symbol:"LTC/BTC",base:"LTC",quote:"BTC",precision:{amount:4,price:5}}},fees:{trading:{maker:5e-4,taker:.0035}}})}async fetchBalance(e={}){let t=(await this.privatePostBalances()).data,i={info:t},a=Object.keys(this.currencies);for(let e=0;e<a.length;e++){let s=a[e],r=this.account();s in t&&(r.free=t[s].available,r.used=t[s].reserved,r.total=t[s].balance),i[s]=r}return this.parseBalance(i)}async fetchOrderBook(e,t,i={}){let a=(await this.publicGetOrderBook(this.extend({currencyPair:this.marketId(e),groupByPriceLimit:"False"},i))).data,s=1e3*a.timestamp;return this.parseOrderBook(a,s,"bids","asks","price","amount")}async fetchTicker(e,t={}){let i=(await this.publicGetTicker(this.extend({currencyPair:this.marketId(e)},t))).data,a=1e3*i.timestamp,s=this.safeFloat(i,"last");return{symbol:e,timestamp:a,datetime:this.iso8601(a),high:this.safeFloat(i,"high"),low:this.safeFloat(i,"low"),bid:this.safeFloat(i,"bid"),bidVolume:void 0,ask:this.safeFloat(i,"ask"),vwap:void 0,askVolume:void 0,open:void 0,close:s,last:s,previousClose:void 0,change:void 0,percentage:void 0,average:void 0,baseVolume:this.safeFloat(i,"amount"),quoteVolume:void 0,info:i}}parseTrade(e,t){return t||(t=this.markets_by_id[e.currencyPair]),{id:e.transactionId,info:e,timestamp:e.timestamp,datetime:this.iso8601(e.timestamp),symbol:t.symbol,type:void 0,side:void 0,price:e.price,amount:e.amount}}async fetchTrades(e,t,i,a={}){let s=this.market(e),r=await this.publicGetTransactions(this.extend({currencyPair:s.id,minutesIntoHistory:10},a));return this.parseTrades(r.data,s,t,i)}async createOrder(e,t,i,a,s,r={}){let o="privatePost"+this.capitalize(i),n={currencyPair:this.marketId(e)};"market"===t?("buy"===i?n.total=a:n.amount=a,o+="Instant"):(n.amount=a,n.price=s,o+=this.capitalize(t));let c=await this[o](this.extend(n,r));return{info:c,id:c.data.toString()}}async cancelOrder(e,t,i={}){return await this.privatePostCancelOrder({orderId:e})}sign(e,t="public",i="GET",a={},s,r){let o=this.urls.api+"/"+e;if("public"===t)Object.keys(a).length&&(o+="?"+this.urlencode(a));else{this.checkRequiredCredentials();let e=this.nonce().toString(),t=e+this.uid+this.apiKey,i=this.hmac(this.encode(t),this.encode(this.secret));r=this.urlencode(this.extend({clientId:this.uid,nonce:e,publicKey:this.apiKey,signature:i.toUpperCase()},a)),s={"Content-Type":"application/x-www-form-urlencoded"}}return{url:o,method:i,body:r,headers:s}}async request(e,i="public",a="GET",s={},r,o){let n=await this.fetch2(e,i,a,s,r,o);if("error"in n&&n.error)throw new t(this.id+" "+this.json(n));return n}};
//# sourceMappingURL=coinmate.js.map