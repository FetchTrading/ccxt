"use strict";const e=require("./base/Exchange"),{ExchangeError:t,NotSupported:s}=require("./base/errors");module.exports=class extends e{describe(){return this.deepExtend(super.describe(),{id:"_1broker",name:"1Broker",countries:"US",rateLimit:1500,version:"v2",has:{publicAPI:!1,CORS:!0,fetchTrades:!1,fetchOHLCV:!0},timeframes:{"1m":"60","15m":"900","1h":"3600","1d":"86400"},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766021-420bd9fc-5ecb-11e7-8ed6-56d0081efed2.jpg",api:"https://1broker.com/api",www:"https://1broker.com",doc:"https://1broker.com/?c=en/content/api-documentation"},requiredCredentials:{apiKey:!0,secret:!1},api:{private:{get:["market/bars","market/categories","market/details","market/list","market/quotes","market/ticks","order/cancel","order/create","order/open","position/close","position/close_cancel","position/edit","position/history","position/open","position/shared/get","social/profile_statistics","social/profile_trades","user/bitcoin_deposit_address","user/details","user/overview","user/quota_status","user/transaction_log"]}}})}async fetchCategories(){let e=(await this.privateGetMarketCategories()).response,t=[];for(let s=0;s<e.length;s++)e[s]&&t.push(e[s]);return t}async fetchMarkets(){let e=this,t=await this.fetchCategories(),s=[];for(let i=0;i<t.length;i++){let r=t[i],a=await e.privateGetMarketList({category:r.toLowerCase()});for(let t=0;t<a.response.length;t++){let i=a.response[t],o=i.symbol,n=void 0,d=void 0,l=void 0;if("FOREX"===r||"CRYPTO"===r){let e=(n=i.name).split("/");d=e[0],l=e[1]}else n=(d=o)+"/"+(l="USD");d=e.commonCurrencyCode(d),l=e.commonCurrencyCode(l),s.push({id:o,symbol:n,base:d,quote:l,info:i})}}return s}async fetchBalance(e={}){await this.loadMarkets();let t=(await this.privateGetUserOverview()).response,s={info:t},i=Object.keys(this.currencies);for(let e=0;e<i.length;e++){s[i[e]]=this.account()}let r=this.safeFloat(t,"balance");return s.BTC.free=r,s.BTC.total=r,this.parseBalance(s)}async fetchOrderBook(e,t,s={}){await this.loadMarkets();let i=(await this.privateGetMarketQuotes(this.extend({symbols:this.marketId(e)},s))).response[0],r=this.parse8601(i.updated),a=[this.safeFloat(i,"bid"),void 0],o=[this.safeFloat(i,"ask"),void 0];return{timestamp:r,datetime:this.iso8601(r),bids:[a],asks:[o],nonce:void 0}}async fetchTrades(e){throw new s(this.id+" fetchTrades () method not implemented yet")}async fetchTicker(e,t={}){await this.loadMarkets();let s=(await this.privateGetMarketBars(this.extend({symbol:this.marketId(e),resolution:60,limit:1},t))).response[0],i=this.parse8601(s.date),r=this.safeFloat(s,"o"),a=this.safeFloat(s,"c"),o=a-r;return{symbol:e,timestamp:i,datetime:this.iso8601(i),high:this.safeFloat(s,"h"),low:this.safeFloat(s,"l"),bid:void 0,bidVolume:void 0,ask:void 0,askVolume:void 0,vwap:void 0,open:r,close:a,last:a,previousClose:void 0,change:o,percentage:o/r*100,average:void 0,baseVolume:void 0,quoteVolume:void 0,info:s}}parseOHLCV(e,t,s="1m",i,r){return[this.parse8601(e.date),parseFloat(e.o),parseFloat(e.h),parseFloat(e.l),parseFloat(e.c),void 0]}async fetchOHLCV(e,t="1m",s,i,r={}){await this.loadMarkets();let a=this.market(e),o={symbol:a.id,resolution:this.timeframes[t]};void 0!==s&&(o.date_start=this.iso8601(s)),void 0!==i&&(o.limit=i);let n=await this.privateGetMarketBars(this.extend(o,r));return this.parseOHLCVs(n.response,a,t,s,i)}async createOrder(e,t,s,i,r,a={}){await this.loadMarkets();let o={symbol:this.marketId(e),margin:i,direction:"sell"===s?"short":"long",leverage:1,type:s};"limit"===t?o.price=r:o.type+="_market";let n=await this.privateGetOrderCreate(this.extend(o,a));return{info:n,id:n.response.order_id}}async cancelOrder(e,t,s={}){return await this.loadMarkets(),await this.privatePostOrderCancel({order_id:e})}sign(e,t="public",s="GET",i={},r,a){this.checkRequiredCredentials();let o=this.urls.api+"/"+this.version+"/"+e+".php",n=this.extend({token:this.apiKey},i);return{url:o+="?"+this.urlencode(n),method:s,body:a,headers:r}}async request(e,s="public",i="GET",r={},a,o){let n=await this.fetch2(e,s,i,r,a,o);if("warning"in n&&n.warning)throw new t(this.id+" "+this.json(n));if("error"in n&&n.error)throw new t(this.id+" "+this.json(n));return n}};
//# sourceMappingURL=_1broker.js.map