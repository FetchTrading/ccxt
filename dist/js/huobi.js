"use strict";const e=require("./base/Exchange"),{ExchangeError:t}=require("./base/errors");module.exports=class extends e{describe(){return this.deepExtend(super.describe(),{id:"huobi",name:"Huobi",countries:"CN",rateLimit:2e3,version:"v3",has:{CORS:!1,fetchOHLCV:!0},timeframes:{"1m":"001","5m":"005","15m":"015","30m":"030","1h":"060","1d":"100","1w":"200","1M":"300","1y":"400"},urls:{logo:"https://user-images.githubusercontent.com/1294454/27766569-15aa7b9a-5edd-11e7-9e7f-44791f4ee49c.jpg",api:"http://api.huobi.com",www:"https://www.huobi.com",doc:"https://github.com/huobiapi/API_Docs_en/wiki"},api:{staticmarket:{get:["{id}_kline_{period}","ticker_{id}","depth_{id}","depth_{id}_{length}","detail_{id}"]},usdmarket:{get:["{id}_kline_{period}","ticker_{id}","depth_{id}","depth_{id}_{length}","detail_{id}"]},trade:{post:["get_account_info","get_orders","order_info","buy","sell","buy_market","sell_market","cancel_order","get_new_deal_orders","get_order_id_by_trade_id","withdraw_coin","cancel_withdraw_coin","get_withdraw_coin_result","transfer","loan","repayment","get_loan_available","get_loans"]}},markets:{"BTC/CNY":{id:"btc",symbol:"BTC/CNY",base:"BTC",quote:"CNY",type:"staticmarket",coinType:1},"LTC/CNY":{id:"ltc",symbol:"LTC/CNY",base:"LTC",quote:"CNY",type:"staticmarket",coinType:2}}})}async fetchBalance(e={}){let t=await this.tradePostGetAccountInfo(),i={info:t},s=Object.keys(this.currencies);for(let e=0;e<s.length;e++){let a=s[e],r=a.toLowerCase(),o=this.account(),d="available_"+r+"_display",n="frozen_"+r+"_display",h="loan_"+r+"_display";d in t&&(o.free=parseFloat(t[d])),n in t&&(o.used=parseFloat(t[n])),h in t&&(o.used=this.sum(o.used,parseFloat(t[h]))),o.total=this.sum(o.free,o.used),i[a]=o}return this.parseBalance(i)}async fetchOrderBook(e,t,i={}){let s=this.market(e),a=s.type+"GetDepthId",r=await this[a](this.extend({id:s.id},i));return this.parseOrderBook(r)}async fetchTicker(e,t={}){let i=this.market(e),s=i.type+"GetTickerId",a=await this[s](this.extend({id:i.id},t)),r=a.ticker,o=1e3*parseInt(a.time);return{symbol:e,timestamp:o,datetime:this.iso8601(o),high:this.safeFloat(r,"high"),low:this.safeFloat(r,"low"),bid:this.safeFloat(r,"buy"),ask:this.safeFloat(r,"sell"),vwap:void 0,open:this.safeFloat(r,"open"),close:void 0,first:void 0,last:this.safeFloat(r,"last"),change:void 0,percentage:void 0,average:void 0,baseVolume:void 0,quoteVolume:this.safeFloat(r,"vol"),info:r}}parseTrade(e,t){let i=e.ts;return{info:e,id:e.id.toString(),order:void 0,timestamp:i,datetime:this.iso8601(i),symbol:t.symbol,type:void 0,side:e.direction,price:e.price,amount:e.amount}}async fetchTrades(e,t,i,s={}){let a=this.market(e),r=a.type+"GetDetailId",o=await this[r](this.extend({id:a.id},s));return this.parseTrades(o.trades,a,t,i)}parseOHLCV(e,t,i="1m",s,a){return[e[0],e[1],e[2],e[3],e[4],e[6]]}async fetchOHLCV(e,t="1m",i,s,a={}){let r=this.market(e),o=r.type+"GetIdKlinePeriod";return await this[o](this.extend({id:r.id,period:this.timeframes[t]},a))}async createOrder(e,t,i,s,a,r={}){let o=this.market(e),d="tradePost"+this.capitalize(i),n={coin_type:o.coinType,amount:s,market:o.quote.toLowerCase()};"limit"===t?n.price=a:d+=this.capitalize(t);let h=this[d](this.extend(n,r));return{info:h,id:h.id}}async cancelOrder(e,t,i={}){return await this.tradePostCancelOrder({id:e})}sign(e,t="public",i="GET",s={},a,r){let o=this.urls.api;if("trade"===t){this.checkRequiredCredentials(),o+="/api"+this.version;let t=this.keysort(this.extend({method:e,access_key:this.apiKey,created:this.nonce()},s)),i=this.urlencode(this.omit(t,"market"));i+="&secret_key="+this.secret,t.sign=this.hash(this.encode(i)),r=this.urlencode(t),a={"Content-Type":"application/x-www-form-urlencoded"}}else{o+="/"+t+"/"+this.implodeParams(e,s)+"_json.js";let i=this.omit(s,this.extractParams(e));Object.keys(i).length&&(o+="?"+this.urlencode(i))}return{url:o,method:i,body:r,headers:a}}async request(e,i="trade",s="GET",a={},r,o){let d=await this.fetch2(e,i,s,a,r,o);if("status"in d&&"error"===d.status)throw new t(this.id+" "+this.json(d));if("code"in d)throw new t(this.id+" "+this.json(d));return d}};
//# sourceMappingURL=huobi.js.map